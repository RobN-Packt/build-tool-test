(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[345],{9676:function(e,t,r){Promise.resolve().then(r.bind(r,4730))},4730:function(e,t,r){"use strict";r.d(t,{NewBookForm:function(){return j}});var n,o,i=r(509),l=r(3263),s=r(681);let a={"Content-Type":"application/json"},u=/\{[^{}]+\}/g;class c extends Request{constructor(e,t){for(let r in super(e,t),t)r in this||(this[r]=t[r])}}function f(e,t,r){if(null==t)return"";if("object"==typeof t)throw Error("Deeply-nested arrays/objects aren’t supported. Provide your own `querySerializer()` to handle these.");return`${e}=${r?.allowReserved===!0?t:encodeURIComponent(t)}`}function p(e,t,r){if(!t||"object"!=typeof t)return"";let n=[],o={simple:",",label:".",matrix:";"}[r.style]||"&";if("deepObject"!==r.style&&!1===r.explode){for(let e in t)n.push(e,!0===r.allowReserved?t[e]:encodeURIComponent(t[e]));let o=n.join(",");switch(r.style){case"form":return`${e}=${o}`;case"label":return`.${o}`;case"matrix":return`;${e}=${o}`;default:return o}}for(let o in t){let i="deepObject"===r.style?`${e}[${o}]`:o;n.push(f(i,t[o],r))}let i=n.join(o);return"label"===r.style||"matrix"===r.style?`${o}${i}`:i}function d(e,t,r){if(!Array.isArray(t))return"";if(!1===r.explode){let n={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[r.style]||",",o=(!0===r.allowReserved?t:t.map(e=>encodeURIComponent(e))).join(n);switch(r.style){case"simple":return o;case"label":return`.${o}`;case"matrix":return`;${e}=${o}`;default:return`${e}=${o}`}}let n={simple:",",label:".",matrix:";"}[r.style]||"&",o=[];for(let n of t)"simple"===r.style||"label"===r.style?o.push(!0===r.allowReserved?n:encodeURIComponent(n)):o.push(f(e,n,r));return"label"===r.style||"matrix"===r.style?`${n}${o.join(n)}`:o.join(n)}function h(e){return function(t){let r=[];if(t&&"object"==typeof t)for(let n in t){let o=t[n];if(null!=o){if(Array.isArray(o)){r.push(d(n,o,{style:"form",explode:!0,...e?.array,allowReserved:e?.allowReserved||!1}));continue}if("object"==typeof o){r.push(p(n,o,{style:"deepObject",explode:!0,...e?.object,allowReserved:e?.allowReserved||!1}));continue}r.push(f(n,o,e))}}return r.join("&")}}function y(e){return JSON.stringify(e)}function m(...e){let t=new Headers;for(let r of e)if(r&&"object"==typeof r)for(let[e,n]of r instanceof Headers?r.entries():Object.entries(r))if(null===n)t.delete(e);else if(Array.isArray(n))for(let r of n)t.append(e,r);else void 0!==n&&t.set(e,n);return t}let b=function(e){let{baseUrl:t="",fetch:r=globalThis.fetch,querySerializer:n,bodySerializer:o,headers:i,...l}={...e};t.endsWith("/")&&(t=t.substring(0,t.length-1)),i=m(a,i);let s=[];async function b(e,a){var b;let v,g;let{fetch:j=r,headers:w,params:x={},parseAs:T="json",querySerializer:R,bodySerializer:E=o??y,...$}=a||{},k="function"==typeof n?n:h(n);R&&(k="function"==typeof R?R:h({..."object"==typeof n?n:{},...R}));let C={redirect:"follow",...l,...$,headers:m(i,w,x.header)};C.body&&(C.body=E(C.body)),C.body instanceof FormData&&C.headers.delete("Content-Type");let S=new c((b={baseUrl:t,params:x,querySerializer:k},v=`${b.baseUrl}${e}`,b.params?.path&&(v=function(e,t){let r=e;for(let n of e.match(u)??[]){let e=n.substring(1,n.length-1),o=!1,i="simple";if(e.endsWith("*")&&(o=!0,e=e.substring(0,e.length-1)),e.startsWith(".")?(i="label",e=e.substring(1)):e.startsWith(";")&&(i="matrix",e=e.substring(1)),!t||void 0===t[e]||null===t[e])continue;let l=t[e];if(Array.isArray(l)){r=r.replace(n,d(e,l,{style:i,explode:o}));continue}if("object"==typeof l){r=r.replace(n,p(e,l,{style:i,explode:o}));continue}if("matrix"===i){r=r.replace(n,`;${f(e,l)}`);continue}r=r.replace(n,"label"===i?`.${l}`:l)}return r}(v,b.params.path)),(g=b.querySerializer(b.params.query??{})).startsWith("?")&&(g=g.substring(1)),g&&(v+=`?${g}`),v),C),A={baseUrl:t,fetch:j,parseAs:T,querySerializer:k,bodySerializer:E};for(let t of s)if(t&&"object"==typeof t&&"function"==typeof t.onRequest){S.schemaPath=e,S.params=x;let r=await t.onRequest(S,A);if(r){if(!(r instanceof Request))throw Error("Middleware must return new Request() when modifying the request");S=r}}let q=await j(S);for(let t=s.length-1;t>=0;t--){let r=s[t];if(r&&"object"==typeof r&&"function"==typeof r.onResponse){S.schemaPath=e,S.params=x;let t=await r.onResponse(q,A,S);if(t){if(!(t instanceof Response))throw Error("Middleware must return new Response() when modifying the response");q=t}}}if(204===q.status||"0"===q.headers.get("Content-Length"))return q.ok?{data:{},response:q}:{error:{},response:q};if(q.ok)return"stream"===T?{data:q.body,response:q}:{data:await q[T](),response:q};let O=await q.text();try{O=JSON.parse(O)}catch{}return{error:O,response:q}}return{GET:async(e,t)=>b(e,{...t,method:"GET"}),PUT:async(e,t)=>b(e,{...t,method:"PUT"}),POST:async(e,t)=>b(e,{...t,method:"POST"}),DELETE:async(e,t)=>b(e,{...t,method:"DELETE"}),OPTIONS:async(e,t)=>b(e,{...t,method:"OPTIONS"}),HEAD:async(e,t)=>b(e,{...t,method:"HEAD"}),PATCH:async(e,t)=>b(e,{...t,method:"PATCH"}),TRACE:async(e,t)=>b(e,{...t,method:"TRACE"}),use(...e){for(let t of e)if(t){if("object"!=typeof t||!("onRequest"in t||"onResponse"in t))throw Error("Middleware must be an object with one of `onRequest()` or `onResponse()`");s.push(t)}},eject(...e){for(let t of e){let e=s.indexOf(t);-1!==e&&s.splice(e,1)}}}}({baseUrl:null!==(o=null===(n=r(4614).env.NEXT_PUBLIC_API_BASE_URL)||void 0===n?void 0:n.replace(/\/$/,""))&&void 0!==o?o:"http://localhost:8080"});async function v(e){let{data:t,error:r}=await b.POST("/books",{body:e});if(r)throw Error(r&&"object"==typeof r&&"message"in r&&"string"==typeof r.message?r.message:r&&"object"==typeof r&&"detail"in r&&"string"==typeof r.detail?r.detail:"Unknown error");return t}let g={title:"",author:"",price:"",currency:"USD",stock:""};function j(){let e=(0,s.useRouter)(),[t,r]=(0,l.useState)(g),[n,o]=(0,l.useState)(!1),[a,u]=(0,l.useState)(null),c=e=>{let{name:t,value:n}=e.target;r(e=>({...e,[t]:n}))},f=async n=>{n.preventDefault(),u(null),o(!0);try{let n={title:t.title.trim(),author:t.author.trim(),price:Number(t.price),currency:t.currency.trim().toUpperCase(),stock:Number(t.stock)};await v(n),r(g),e.push("/")}catch(e){u(e instanceof Error?e.message:"Failed to create book.")}finally{o(!1)}};return(0,i.jsxs)("form",{onSubmit:f,style:{maxWidth:480,display:"grid",gap:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"title",children:"Title"}),(0,i.jsx)("input",{id:"title",name:"title",type:"text",required:!0,value:t.title,onChange:c,placeholder:"Book title"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"author",children:"Author"}),(0,i.jsx)("input",{id:"author",name:"author",type:"text",required:!0,value:t.author,onChange:c,placeholder:"Author name"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"price",children:"Price"}),(0,i.jsx)("input",{id:"price",name:"price",type:"number",min:"0",step:"0.01",required:!0,value:t.price,onChange:c,placeholder:"0.00"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"currency",children:"Currency"}),(0,i.jsx)("input",{id:"currency",name:"currency",type:"text",required:!0,maxLength:3,value:t.currency,onChange:c,placeholder:"USD"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"stock",children:"Stock"}),(0,i.jsx)("input",{id:"stock",name:"stock",type:"number",min:"0",required:!0,value:t.stock,onChange:c,placeholder:"0"})]}),a?(0,i.jsx)("p",{role:"alert",style:{color:"crimson"},children:a}):null,(0,i.jsx)("button",{type:"submit",disabled:n,children:n?"Saving…":"Create Book"})]})}},4614:function(e,t,r){"use strict";var n,o;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(o=r.g.process)?void 0:o.env)?r.g.process:r(6464)},6464:function(e){!function(){var t={229:function(e){var t,r,n,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(e){r=l}}();var a=[],u=!1,c=-1;function f(){u&&n&&(u=!1,n.length?a=n.concat(a):c=-1,a.length&&p())}function p(){if(!u){var e=s(f);u=!0;for(var t=a.length;t;){for(n=a,a=[];++c<t;)n&&n[c].run();c=-1,t=a.length}n=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new d(e,t)),1!==a.length||u||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}},l=!0;try{t[e](i,i.exports,n),l=!1}finally{l&&delete r[e]}return i.exports}n.ab="//";var o=n(229);e.exports=o}()}},function(e){e.O(0,[452,693,744],function(){return e(e.s=9676)}),_N_E=e.O()}]);